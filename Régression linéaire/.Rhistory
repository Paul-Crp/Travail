library(readr)
cocktails <- read_delim("cocktails.csv",
delim = "\t", escape_double = FALSE,
trim_ws = TRUE)
View(cocktails)
install.packages("ade4")
CockVarNom = cocktails[,1:2]
CockVarQuant = cocktails[,3:15]
library("ade4", lib.loc="~/Library/R/4.0/library")
library(ade4)
CockVarNomIndic = acm.disjonctif(CockVarNom)
install.packages("vctrs")
install.packages("vctrs")
install.packages("C:/Users/Pol/AppData/Local/Temp/RtmpmMSUSl/downloaded_packages/vctrs_0.4.2.zip", repos = NULL, type = "win.binary")
install.packages("vctrs")
install.packages("Rtools")
q()
setwd("C:/Users/Pol/Desktop/RStudio/Régression linéaire")
ozone <- read.csv("C:/Users/Pol/Desktop/RStudio/Régression linéaire/ozone.txt", sep="")
View(ozone)
attach(ozone)
maxO3
plot(T12,maxO3)
plot(maxO3,T12)
plot(T12,maxO3)
mean(maxO3)
mean(T12)
length(maxO3)
beta1=0
for (i in 1:length(maxO3)){
beta1=i
}
maxO3[0]
maxO3[1]
maxO3[length(maxO3)]
xx=mean(maxO3)
yy=mean(T12)
beta1=0
a=0
b=0
for (i in 1:length(maxO3)){
a=a+(maxO3[i]-yy)(T12[i]-xx)
b=b+((T12[i]-xx)^2)
beta1=a/b
}
beta1=0
a=0
b=0
for (i in 1:length(maxO3)){
a=a+(maxO3[i]-yy)*(T12[i]-xx)
b=b+((T12[i]-xx)^2)
beta1=a/b
}
beta0=yy-beta1*xx
abline(beta0,beta1)
abline(beta1,beta0)
lines(beta0~beta1)
lines(beta1~beta0)
plot(beta1,beta0)
plot(T12,maxO3)
yy=mean(maxO3)
xx=mean(T12)
beta1=0
a=0
b=0
for (i in 1:length(maxO3)){
a=a+(maxO3[i]-yy)*(T12[i]-xx)
b=b+((T12[i]-xx)^2)
beta1=a/b
}
beta0=yy-beta1*xx
abline(c(beta0,beta1))
plot(T12,maxO3)
abline(beta0,beta1)
lines(T12*beta1+beta0)
plot(T12,maxO3)
abline(c(beta0,beta1))
lines(T12*beta1+beta0,T12)
points(T12*beta1+beta0,T12)
points(T12*beta1+beta0~T12)
residus=T12*beta1+beta0-maxO3
mean(residus)
cov(T12,maxO3)/var(T12)
sum((T12-xx)*(maxO3-yy))/sum((T12-xx)^2)
ggplot(residus) + geom_histogram()
library(ggplot2)
ggplot(residus) + geom_histogram()
hist(residus)
sigmacarré = sum(residus^2)/length(maxO3-2)
sum(residus^2)
sum(residus^2)/110
sigmacarré = sum(residus^2)/(length(maxO3)-2)
sigmacarre = sum(residus^2)/(length(maxO3)-2)
sigma=sigmacarré^0.5
sigma=sigmacarre^0.5
plot(T12,maxO3)
abline(c(beta0,beta1))
points(T12*beta1+beta0~T12)
var(residus)
cov(residus)
SCE= sum((T12*beta1+beta0-yy)^2)
SCT= sum((maxO3-yy)^2)
SCR= sum((maxO3-T12*beta1+beta0)^2)
Rcarre=SCE/SCT
1-SCR/SCT
1-(SCR/SCT)
SCR= sum((maxO3-(T12*beta1+beta0))^2)
SCE+SCR
SCE+SCR-SCT
Rcarre=SCE/SCT
1-(SCR/SCT)
((sum(T12-xx)(maxO3-yy))^2)/(sum((T12-xx)^2)*sum((maxO3-yy)^2))
((sum(T12-xx)(maxO3-yy))^2)/(sum((T12-xx)^2)*sum((maxO3-yy)^2))
((sum(T12-xx)*(maxO3-yy))^2)/(sum((T12-xx)^2)*sum((maxO3-yy)^2))
((sum(T12-xx)*(maxO3-yy))^2)
sum((T12-xx)*(maxO3-yy))
((sum((T12-xx)*(maxO3-yy)))^2)/(sum((T12-xx)^2)*sum((maxO3-yy)^2))
(sum((T12-xx)*(maxO3-yy)))/((sum(T12-xx))*(sum(maxO3-yy)))
((sum(T12-xx))*(sum(maxO3-yy)))
((sum((T12-xx)*(maxO3-yy)))^2)/(sum((T12-xx)^2)*sum((maxO3-yy)^2))
rocarre=((sum((T12-xx)*(maxO3-yy)))^2)/(sum((T12-xx)^2)*sum((maxO3-yy)^2))
ro=(sum((T12-xx)*(maxO3-yy)))/(((sum((T12-xx)^2))^0.5)*((sum((maxO3-yy)^2))^0.5))
ro^2
var(residus)
(sigmacarre/length(maxO3))*(1+(((xx)^2)/(sum((T12-xx)^2))))
(sigmacarre/length(maxO3))*(1+(((yy)^2)/(sum((T12-xx)^2))))
(sigmacarre/(length(maxO3)))*(1+(((xx)^2)/(sum((T12-xx)^2))))
(sigmacarre/(length(maxO3)))*(1+(((xx)^2)/(var(T12)))
)
sqrt(80.90001)
(sigmacarre/(length(maxO3)))*(1+(((xx)^2)/(sum((T12-xx)^2))))
(sigmacarre/(length(maxO3)))*(1+(((xx)^2)/(sum((T12-xx)^2))/112))
(sigmacarre/(length(maxO3)))*(1+(((xx)^2)/((sum((T12-xx)^2))/111)))
(sum((T12-xx)^2))/111
(var(T12))/(length(maxO3)-1)
(sum((T12-xx)^2))/(length(maxO3)-1)
(var(T12))
varbeta1=(sigmacarre/(length(maxO3)))*(1+(((xx)^2)/((sum((T12-xx)^2))/111)))
varbeta0=(sigmacarre/(length(maxO3)))*(1+(((xx)^2)/((sum((T12-xx)^2))/111)))
varbeta1=(sigmacarre/(length(maxO3)))/var(T12)
sqrt(80.90001)
sqrt(0.168632021966831)
ro=(sum((T12-xx)*(maxO3-yy)))/(((sum((T12-xx)^2))^0.5)*((sum((maxO3-yy)^2))^0.5))
ro*ro
ro*ro-rcarre
ro*ro-Rcarre
reg=lm(maxO3~T12)
reg=lm(maxO3~T12)
summary()
reg=lm(maxO3~T12)
summary(reg)
R2ajt= 1- (1-Rcarre)*(111)/(length(maxO3-1-1))
R2ajt= 1- (((1-Rcarre)*(111))/(length(maxO3-1-1)))
R2ajt= 1- (((1-Rcarre)*(111))/(length(maxO3)-1-1))
R2ajt= 1- (1-Rcarre)*length(maxO3)/(length(maxO3)-1-1)
R2ajt= 1- ((1-Rcarre)*length(maxO3)/(length(maxO3)-1-1))
R2ajt= 1- (((1-Rcarre)*length(maxO3))/(length(maxO3)-1-1))
R2ajt= 1- (((1-Rcarre)*(length(maxO3)))/(length(maxO3)-1-1))
R2ajt= 1- ((1-Rcarre)*(length(maxO3)-1)/(length(maxO3)-1-1))
R2ajt= 1- (1-Rcarre)*(length(maxO3)-1)/(length(maxO3)-1-1)
varbeta0=(sigmacarre/(length(maxO3)-1))*(1+(((xx)^2)/((sum((T12-xx)^2))/111)))
sqrt(varbeta0)
sqrt(varbeta1)
varbeta1=(sigmacarre/(length(maxO3)-1))/(var(T12))
sqrt(varbeta1)
coef(beta0)
help("coef")
help("confint")
confint(reg)
confint(reg)[1,1]
quantile = qt(0.975, df = 110)
coef(reg)
coef(resume(reg))
coef(reg)
summary(reg)
coef(reg)
summary(reg)[1,1]
coef(reg)
summary(reg)
summary(reg)[1,1]
coef(summary(reg))
coef(reg)
resume=summary(reg)
beta0min= coef(resume)[1,1] - quantile*coef(resume)[1,2]
beta0max= coef(resume)[1,1] + quantile*coef(resume)[1,2]
beta1min= coef(resume)[2,1] - quantile*coef(resume)[2,2]
beta1max= coef(resume)[2,1] + quantile*coef(resume)[2,2]
confint(reg)
confint(reg, lvl=0.95)
confint(reg, lvl=0.85)
confint(reg, level=0.85)
install.packages(ellipses)
install.packages("ellipses")
install.packages("ellipse")
install.packages(c("cli", "httpuv", "survival"))
install.packages("ellipse")
library(ellipse)
plot(ellipse(reg,level=0.95))
points(coef(resume)[1,1],coef(resume)[2,1])
points(coef(resume)[1,1],coef(resume)[2,1])
lines(c(beta0min, beta0min,beta0max,beta0max,beta0min), c(beta1min, beta1max,beta1max,beta1min,beta1min))
help(qt)
quantile1 = qchisq(0.025,df=110)
quantile2 = qchisq(0.975,df=110)
resume$sigma
resume
sigmamin = (110)*(resuma$sigma)^2 / quantile2
sigmamin = (110)*(resume$sigma)^2 / quantile2
sigmamax = (110)*(resume$sigma)^2 / quantile1
quantile1 = qchisq(0.025,df=110)
quantile2 = qchisq(0.975,df=110)
sigmamin = (110)*(resume$sigma)^2 / quantile2
sigmamax = (110)*(resume$sigma)^2 / quantile1
sqrt(c(sigmamin,sigmamax))
predict(reg, new=data.frame(T12=40))
predict(reg, new=data.frame(T12=40), interval="confidence", level=0.95)
IC= predict(reg, new=data.frame(T12), interval="confidence", level=0.95)
IC= predict(reg, new=data.frame(T12), interval="confidence", level=0.95)
IC
lines(T12, IC[,2])
plot(T12,maxO3)
abline(c(beta0,beta1))
lines(T12, IC[,2])
lines(T12, IC[,2], lty=2)
T1212= seq(min(T12), max(T12), length=100)
lines(T1212, IC[,3], lty=2)
T1212= seq(min(T12), max(T12), length=112)
lines(T1212, IC[,3], lty=2)
IC= predict(reg, new=data.frame(T1212), interval="confidence", level=0.95)
lines(T1212, IC[,3], lty=2)
plot(T12,maxO3)
abline(c(beta0,beta1))
lines(T1212, IC[,3], lty=2)
plot(T12,maxO3)
abline(c(beta0,beta1))
T1212= seq(min(T12), max(T12), length=100)
IC= predict(reg, new=data.frame(T1212), interval="confidence", level=0.95)
lines(T1212, IC[,3], lty=2)
T1212= seq(min(T12), max(T12), length=112)
IC= predict(reg, new=data.frame(T1212), interval="confidence", level=0.95)
lines(T1212, IC[,3], lty=2)
reg=lm(maxO3~T12)
plot(T12,maxO3)
quantile1 = qchisq(0.025,df=110)
quantile2 = qchisq(0.975,df=110)
sigmamin = (110)*(resume$sigma)^2 / quantile2
sigmamax = (110)*(resume$sigma)^2 / quantile1
sqrt(c(sigmamin,sigmamax))
predict(reg, new=data.frame(T12=40))
predict(reg, new=data.frame(T12=40), interval="confidence", level=0.95)
T1212= seq(min(T12), max(T12), length=112)
IC= predict(reg, new=data.frame(T1212), interval="confidence", level=0.95)
View(IC)
T1212= seq(min(T12), max(T12), length=112)
IC= predict(reg, new=data.frame(T1212), interval="confidence", level=0.95)
summary(reg)
ICpred= predict(reg, new=data.frame(T1212), interval="prediction", level=0.95)
View(ICpred)
T12= seq(min(T12), max(T12), length=112)
IC= predict(reg, new=data.frame(T12), interval="confidence", level=0.95)
lines(T12, IC[,3], lty=2)
ICpred= predict(reg, new=data.frame(T12), interval="prediction", level=0.95)
lines(T12, ICpred[,3], lty=2)
